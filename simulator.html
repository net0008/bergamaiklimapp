<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Bergama 2050: Karar MasasÄ±</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --dark: #2c3e50; --temp-red: #e74c3c; --btn: #2980b9; --green: #27ae60; }
        body { font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; transition: 0.5s; background: #eee; }
        body.child-mode { background: #1a1a1a; color: #55FF55; }
        .main-wrapper { max-width: 1000px; margin: auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        body.child-mode .main-wrapper { background: #000; border: 2px solid #55FF55; color: #fff; }
        
        .nav-bar { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .nav-btn { padding: 12px 25px; border-radius: 50px; border:none; color:white; font-weight:bold; cursor:pointer; text-decoration:none; display:inline-block; }
        .locked { background: #7f8c8d !important; opacity: 0.5; cursor: not-allowed; }

        #mission-status { margin-bottom: 20px; padding: 20px; border-radius: 12px; border-left: 6px solid var(--temp-red); background: #f9f9f9; font-weight: bold; line-height: 1.5; }
        body.child-mode #mission-status { background: #222; color: #55FF55; }
        
        .slider-group { margin-bottom: 15px; padding: 10px; background: rgba(0,0,0,0.03); border-radius: 10px; }
        .slider { width: 100%; cursor: pointer; }
        
        /* Modal */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; backdrop-filter: blur(5px); }
        .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 20px; max-width: 500px; width: 90%; color: black; }
    </style>
</head>
<body id="mainBody">

    <div class="main-wrapper">
        <h2 id="modeTitle" style="text-align:center; margin-top:0;"></h2>
        <div id="top-slogan" style="font-style:italic; text-align:center; margin-bottom:20px; font-weight:bold;"></div>
        
        <div class="nav-bar">
            <a href="secim.html" class="nav-btn" style="background:var(--dark)">ğŸ”™ Mod DeÄŸiÅŸtir</a>
            <button onclick="toggleModal()" class="nav-btn" style="background:#f39c12">â„¹ï¸ NasÄ±l KullanÄ±lÄ±r?</button>
        </div>

        <div id="mission-status">YÃ¼kleniyor...</div>
        
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;">
            <div class="controls">
                <div class="slider-group"><label>âš¡ Temiz Enerji: <span id="v1">20</span>%</label><input type="range" min="0" max="100" value="20" class="slider" id="s1"></div>
                <div class="slider-group"><label>ğŸŒ³ AÄŸaÃ§: <span id="v2">100.000</span></label><input type="range" min="0" max="1000000" value="100000" step="10000" class="slider" id="s2"></div>
                <div class="slider-group"><label>ğŸšœ AkÄ±llÄ± TarÄ±m: <span id="v3">30</span>%</label><input type="range" min="0" max="100" value="30" class="slider" id="s3"></div>
                <div style="text-align:center; margin-top:20px;">
                    <a href="ayak-izi.html" id="karne-btn" class="nav-btn locked">ğŸ”’ Ã–nce GÃ¶revi BaÅŸar</a>
                </div>
            </div>
            <div class="results">
                <canvas id="simChart" style="max-height: 230px; background:white; border-radius:10px; padding:10px;"></canvas>
                <div style="display:flex; justify-content:space-between; margin-top:10px; font-weight:bold; background:rgba(255,255,255,0.8); color:black; padding:10px; border-radius:10px;">
                    <span>B. IsÄ±: <span id="bt">23.1</span>Â°C</span>
                    <span>TR IsÄ±: <span id="trt">16.8</span>Â°C</span>
                </div>
            </div>
        </div>
    </div>

    <div id="helpModal" class="modal-overlay">
        <div class="modal-content">
            <h2 id="modalTitle">ğŸ® NasÄ±l KullanÄ±lÄ±r?</h2>
            <hr>
            <div id="modalBody" style="text-align: left; padding: 10px; line-height: 1.6;"></div>
            <button onclick="toggleModal()" class="nav-btn" style="width:100%; background:var(--green);">AnladÄ±m!</button>
        </div>
    </div>

    <script>
        let simChart;
        const mode = localStorage.getItem('user_mode') || 'child';
        document.body.className = mode + '-mode';
        
        document.getElementById('modeTitle').innerText = mode === 'adult' ? 'STRATEJÄ° MODU' : 'KAHRAMAN MODU';
        document.getElementById('top-slogan').innerText = mode === 'adult' ? "Ã‡evre iÃ§in fedakarlÄ±k yapmazsanÄ±z, Ã§ocuklarÄ±nÄ±z iÃ§in fedakarlÄ±k yapmaya gerek yok." : "YaÅŸamak ya da yaÅŸamamak; tÃ¼m mesele senin kararÄ±n!";

        // Modal Ä°Ã§eriÄŸi Dinamik Olarak AyarlandÄ±
        if (mode === 'adult') {
            document.getElementById('modalTitle').innerText = "ğŸ“Š Strateji Modu Nedir?";
            document.getElementById('modalBody').innerHTML = "<p>â€¢ <b>Karar Al:</b> SÃ¼rgÃ¼lerle 2050 projeksiyonunu belirleyin.</p><p>â€¢ <b>Etkiyi GÃ¶r:</b> YanlÄ±ÅŸ kararlarÄ±n ekonomik ve yaÅŸamsal maliyetini okuyun.</p><p>â€¢ <b>Hedef:</b> Bergama'yÄ± 22.2Â°C'nin altÄ±nda tutarak Ã§ocuklarÄ±nÄ±za yaÅŸanabilir bir miras bÄ±rakÄ±n.</p>";
        } else {
            document.getElementById('modalTitle').innerText = "ğŸ® GÃ¶revin: DÃ¼nyayÄ± Kurtar!";
            document.getElementById('modalBody').innerHTML = "<p>â€¢ <b>Karar Al:</b> SÃ¼rgÃ¼lerle doÄŸa dostu kararlar ver.</p><p>â€¢ <b>Etkiyi GÃ¶r:</b> IsÄ±yÄ± dÃ¼ÅŸÃ¼rÃ¼p yaÄŸÄ±ÅŸÄ± artÄ±rmaya Ã§alÄ±ÅŸ.</p><p>â€¢ <b>Hedef:</b> 2050'de Bergama'yÄ± 22.2Â°C'nin altÄ±na indirip gaz maskelerinden kurtul!</p>";
        }

        function toggleModal() {
            const m = document.getElementById('helpModal');
            m.style.display = (m.style.display === 'block') ? 'none' : 'block';
        }

        function update() {
            const e = parseInt(document.getElementById('s1').value);
            const t = parseInt(document.getElementById('s2').value);
            const w = parseInt(document.getElementById('s3').value);

            let bt = 23.1 - (e * 0.025) - (t * 0.00000035);
            let trt = 16.8 - (e * 0.015) - (t * 0.0000001);
            
            document.getElementById('v1').innerText = e;
            document.getElementById('v2').innerText = t.toLocaleString('tr-TR');
            document.getElementById('v3').innerText = w;
            document.getElementById('bt').innerText = bt.toFixed(1);
            document.getElementById('trt').innerText = trt.toFixed(1);

            const msgBox = document.getElementById('mission-status');
            const btn = document.getElementById('karne-btn');

            if (mode === 'adult') {
                msgBox.innerHTML = bt > 22.2 ? "âŒ Dikkat: Bu konfor tercihi, 2050'de Ã§ocuÄŸunuzun soluduÄŸu havadan Ã§alÄ±yor!" : "âœ… Tebrikler: BugÃ¼nÃ¼n fedakarlÄ±ÄŸÄ±, Ã§ocuÄŸunuzun 2050'deki huzuru olacak.";
            } else {
                msgBox.innerHTML = bt > 22.2 ? "âš ï¸ Eyvah! Bu gidiÅŸle 2050'de evden Ã§Ä±karken gaz maskeni unutmamalÄ±sÄ±n!" : "ğŸ›¡ï¸ Harika! GeleceÄŸini maskelerden kurtardÄ±n Kahraman!";
            }

            if (bt <= 22.2) {
                btn.className = "nav-btn"; btn.style.background = "#27ae60"; btn.innerText = "â¡ï¸ KiÅŸisel Teste GeÃ§";
                msgBox.style.borderColor = "#27ae60";
            } else {
                btn.className = "nav-btn locked"; btn.innerText = "ğŸ”’ Gelecek Tehlikede";
                msgBox.style.borderColor = "var(--temp-red)";
            }

            const data = [bt, trt];
            if(!simChart) {
                simChart = new Chart(document.getElementById('simChart'), {
                    type: 'bar', data: { labels: ['Bergama IsÄ±', 'TÃ¼rkiye IsÄ±'], datasets: [{ data: data, backgroundColor: ['#e74c3c','#3498db'] }] },
                    options: { plugins: { legend: {display: false} }, scales: { y: { max: 25 } } }
                });
            } else { simChart.data.datasets[0].data = data; simChart.update('none'); }

            localStorage.setItem('sim_energy', e);
            localStorage.setItem('sim_trees', t);
            localStorage.setItem('sim_water', w);
            localStorage.setItem('sim_temp', bt.toFixed(1));
        }
        ['s1', 's2', 's3'].forEach(id => document.getElementById(id).oninput = update);
        window.onload = update;
    </script>
</body>
</html>