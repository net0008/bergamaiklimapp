<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bergama 2050: Ä°klim SimÃ¼latÃ¶rÃ¼</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root { --dark: #2c3e50; --temp-red: #e74c3c; --rain-blue: #3498db; --btn: #2980b9; --green: #27ae60; }
        
        body { 
            font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; color: var(--dark); min-height: 100vh;
            background-image: url('imagery/bergama-bg.jpg'); background-size: cover; background-position: center; background-attachment: fixed;
            overflow-x: hidden;
        }

        #bg-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0;
            background-color: rgba(220, 100, 0, 0.4); transition: background-color 1.5s ease; pointer-events: none;
        }

        .main-wrapper {
            position: relative; z-index: 1; background: rgba(255, 255, 255, 0.2); backdrop-filter: blur(12px);
            border-radius: 25px; padding: 30px; box-shadow: 0 15px 35px rgba(0,0,0,0.3); max-width: 1100px; margin: auto;
        }

        .container { display: grid; grid-template-columns: 1fr 1.5fr; gap: 30px; }
        .header { grid-column: span 2; text-align: center; margin-bottom: 10px; }
        
        .nav-bar { display: flex; justify-content: center; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .nav-btn { padding: 10px 20px; background: var(--btn); color: white; text-decoration: none; border-radius: 50px; font-weight: bold; border:none; cursor:pointer; transition: 0.3s; }
        
        /* Kilitli DÃ¼ÄŸme TasarÄ±mÄ± */
        .locked { background: #7f8c8d !important; cursor: not-allowed; opacity: 0.6; }

        .slider-group { margin-bottom: 20px; background: rgba(255, 255, 255, 0.7); padding: 15px; border-radius: 15px; }
        .slider { width: 100%; cursor: pointer; -webkit-appearance: none; appearance: none; height: 10px; background: #dfe6e9; border-radius: 5px; }
        .slider::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 25px; height: 25px; background: var(--btn); border-radius: 50%; border: 3px solid white; }

        .stat-card { background: rgba(255,255,255,0.9); padding: 15px; border-radius: 15px; text-align: center; font-weight: bold; }
        .output-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }

        #mission-status { margin-top:15px; padding:15px; border-radius:12px; text-align:center; font-weight:bold; background: white; border: 2px solid var(--temp-red); }
    </style>
</head>
<body>

<div id="bg-overlay"></div>

<div class="main-wrapper">
    <div class="container">
        <div class="header">
            <h1>ğŸ›ï¸ Bergama & TR 2050: Ä°klim Karar MasasÄ±</h1>
            <div class="nav-bar">
                <a href="index.html" class="nav-btn">ğŸ  Anasayfa</a>
                <button onclick="toggleFullScreen()" class="nav-btn" style="background:var(--dark)">ğŸ“º Tam Ekran</button>
                <a href="ayak-izi.html" id="karne-btn" class="nav-btn locked">ğŸ”’ Ã–nce Bergama'yÄ± Kurtar</a>
            </div>
        </div>

        <div class="controls">
            <div id="mission-status">âš ï¸ DURUM: Bergama kavruluyor!</div>
            
            <div class="slider-group">
                <label>âš¡ Temiz Enerji YatÄ±rÄ±mÄ±: <span id="v1">20</span>%</label>
                <input type="range" min="0" max="100" value="20" class="slider" id="s1">
            </div>
            <div class="slider-group">
                <label>ğŸŒ³ Dikilecek AÄŸaÃ§: <span id="v2">100.000</span> Adet</label>
                <input type="range" min="0" max="1000000" value="100000" step="10000" class="slider" id="s2">
            </div>
            <div class="slider-group">
                <label>ğŸšœ AkÄ±llÄ± TarÄ±m & Su: <span id="v3">30</span>%</label>
                <input type="range" min="0" max="100" value="30" class="slider" id="s3">
            </div>
        </div>

        <div class="results">
            <div style="background:white; border-radius:15px; padding:10px;"><canvas id="simChart" style="height:250px;"></canvas></div>
            <div class="output-grid">
                <div class="stat-card" style="border-bottom:4px solid var(--temp-red);"><span>Bergama IsÄ±</span><div id="bt">23.1Â°C</div></div>
                <div class="stat-card" style="border-bottom:4px solid var(--rain-blue);"><span>Bergama YaÄŸÄ±ÅŸ</span><div id="br">340mm</div></div>
                <div class="stat-card" style="border-bottom:4px solid var(--temp-red);"><span>TR Genel IsÄ±</span><div id="trt">16.8Â°C</div></div>
                <div class="stat-card" style="border-bottom:4px solid var(--rain-blue);"><span>TR Genel YaÄŸÄ±ÅŸ</span><div id="trr">475mm</div></div>
            </div>
        </div>
    </div>
</div>

<script>
    let simChart;
    const overlay = document.getElementById('bg-overlay');

    function toggleFullScreen() {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else document.exitFullscreen();
    }

    function update() {
        const energy = parseInt(document.getElementById('s1').value);
        const trees = parseInt(document.getElementById('s2').value);
        const water = parseInt(document.getElementById('s3').value);

        // Ã–nce Hesapla
        let bt = 23.1 - (energy * 0.025) - (trees * 0.00000035);
        let trt = 16.8 - (energy * 0.015) - (trees * 0.0000001);
        let br = 340 + (water * 2.2) + (trees * 0.00003);
        let trr = 475 + (water * 1.5) + (trees * 0.000015);

        // Sonra Kaydet ve YazdÄ±r
        document.getElementById('v1').innerText = energy;
        document.getElementById('v2').innerText = trees.toLocaleString('tr-TR');
        document.getElementById('v3').innerText = water;
        document.getElementById('bt').innerText = bt.toFixed(1) + "Â°C";
        document.getElementById('br').innerText = Math.round(br) + "mm";
        document.getElementById('trt').innerText = trt.toFixed(1) + "Â°C";
        document.getElementById('trr').innerText = Math.round(trr) + "mm";

        localStorage.setItem('sim_energy', energy);
        localStorage.setItem('sim_trees', trees);
        localStorage.setItem('sim_water', water);
        localStorage.setItem('sim_temp', bt.toFixed(1));

        // Kilit MekanizmasÄ±
        const btn = document.getElementById('karne-btn');
        const status = document.getElementById('mission-status');

        if (bt > 22.5) {
            btn.className = "nav-btn locked";
            btn.innerText = "ğŸ”’ Durum Kritik (DÃ¼zelmeli)";
            btn.onclick = (e) => e.preventDefault();
            status.innerHTML = "ğŸ”´ Bergama kavruluyor! Acil Ã¶nlem al.";
            status.style.borderColor = "var(--temp-red)";
        } else {
            btn.className = "nav-btn";
            btn.style.background = "var(--green)";
            btn.innerText = "ğŸ† GÃ¶revi TamamladÄ±n! Karneni Al";
            btn.onclick = null;
            status.innerHTML = "ğŸŸ¢ Harika! Bergama nefes alÄ±yor.";
            status.style.borderColor = "var(--green)";
        }

        // Grafik GÃ¼ncelleme
        const chartData = [bt.toFixed(1), trt.toFixed(1), (br/20).toFixed(1), (trr/20).toFixed(1)];
        if(!simChart) {
            const ctx = document.getElementById('simChart').getContext('2d');
            simChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['B. IsÄ±', 'TR IsÄ±', 'B. YaÄŸÄ±ÅŸ*', 'TR YaÄŸÄ±ÅŸ*'],
                    datasets: [{ data: chartData, backgroundColor: ['#e74c3c','#ff7675','#3498db','#74b9ff'] }]
                },
                options: { responsive: true, maintainAspectRatio: false, plugins: { legend: {display: false} } }
            });
        } else { simChart.data.datasets[0].data = chartData; simChart.update('none'); }

        let score = (energy/100 + water/100 + trees/1000000) / 3;
        overlay.style.backgroundColor = `hsla(${20 + (score * 100)}, 70%, 45%, 0.45)`;
    }

    ['s1', 's2', 's3'].forEach(id => document.getElementById(id).oninput = update);
    window.onload = update;
</script>
</body>
</html>